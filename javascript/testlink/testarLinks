function testLinks() {
  var links = document.querySelectorAll('a');
  var linkResults = [];

  links.forEach(function(link) {
    if (!link.hasAttribute('href') || link.getAttribute('href') === '') {
      linkResults.push({ href: '', location: link.outerHTML, status: 'Error' });
      return;
    }
    
    var xhr = new XMLHttpRequest();
    xhr.open('GET', link.href, true);
    xhr.onload = function() {
      if (xhr.status >= 200 && xhr.status < 300) {
        linkResults.push({ href: link.href, location: link.outerHTML, status: 'OK' });
      } else {
        linkResults.unshift({ href: link.href, location: link.outerHTML, status: 'Error' });
      }
      displayTable(linkResults);
    };
    xhr.onerror = function() {
      linkResults.unshift({ href: link.href, location: link.outerHTML, status: 'Error' });
      displayTable(linkResults);
    };
    xhr.send();
  });
}

function displayTable(linkResults) {
  console.clear();
  console.table(linkResults, ['status', 'href', 'location'], ['width: 80px', 'width: 80px', '']);
}

testLinks();  
